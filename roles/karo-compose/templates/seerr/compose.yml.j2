# SPDX-FileCopyrightText: 2025 hazzuk
#
# SPDX-License-Identifier: AGPL-3.0-only

---
name: seerr
services:

  seerr:
    # https://github.com/seerr-team/seerr
    # https://hub.docker.com/r/fallenbagel/jellyseerr
    # https://hub.docker.com/r/seerr/seerr (future)
    image: docker.io/fallenbagel/jellyseerr:preview-OIDC@sha256:9f3195998306da6548fc3b2420d114dda64a6e904f41e911168788fb410a7972
    container_name: seerr
    restart: {{ karo_compose_restart_policy }}
    # init: true
    networks:
      - egress_seerr
      - frontend
    volumes:
      - type: volume
        source: seerr_data
        target: /app/config
      - /srv/docker/seerr/logo_full.svg:/app/public/logo_full.svg
      - /srv/docker/seerr/logo_stacked.svg:/app/public/logo_stacked.svg
    labels:
      - traefik.enable=true
      - traefik.http.routers.seerr.rule=Host(`{{ karo_compose_seerr_domain }}`)
      - traefik.http.services.seerr.loadbalancer.server.port=5055
    environment:
      - LOG_LEVEL={{ karo_compose_seerr_log_level }}
      - TZ={{ karo_compose_timezone }}
    healthcheck:
      test: wget --no-verbose --tries=1 --spider http://localhost:5055/api/v1/status || exit 1
      start_period: 20s
      timeout: 3s
      interval: 15s
      retries: 3

networks:
  egress_seerr:
    name: egress_seerr
    driver: bridge
    internal: false
  frontend:
    external: true

volumes:
  seerr_data:
    name: seerr_data
